---
marp: true
author: carlos.quintella@uva.br
backgroundColor: white
paginate: true
theme: gaia
---

# Organização do Programa C na Memória #

![segmentação da memória de um programam C](https://www.inf.ufpr.br/roberto/ci067/pics/areas-memoria.png)

fonte: Sistemas Operacionais: Conceitos e Mecanismos, Cap 15.

---

````text
+------------+
|   STACK    | dados de funcs., parâm., end de ret.
+------------+
|    ...     | área livre
|    ...     | 
+------------+
|    HEAP    | variáveis dinâmicas
+------------+
|    BSS     | variáveis não inicializadas
+------------+
|    DATA    | variáveis inicializadas
+------------+
|    TEXT    | código binário
+------------+
````

---

## Text

Contém o código binário a ser executado pelo processo, gerado durante a compilação e a ligação com as bibliotecas. É armazenado no arquivo executável e situa-se no início do espaço de endereçamento do processo. Esta seção tem tamanho fixo, calculado durante a compilação.

## Data

Esta seção contém as variáveis estáticas inicializadas, ou seja, variáveis que estão definidas do início ao fim da execução do processo e cujo valor inicial é declarado no código-fonte do programa. Esses valores iniciais são armazenados no arquivo do programa executável, sendo então carregados para esta seção de memória quando o processo inicia. Nesta seção são armazenadas tanto variáveis globais quanto variáveis locais estáticas (por exemplo, declaradas como static em C).

## Stack

A PILHA (stack) é uma estrutura de dados do tipo FIFO (first-in, first-out) usada para armazenar as variáveis usadas dentro de uma função, além do endereço de retorno quando a função é finalizada.

- Sempre que uma função declara uma nova variável, ela é alocada na pilha.
- A pilha "cresce" do endereço maior para o menor, em direção à área de memória do HEAP.
- Quando a função retorna, as variáveis são desempilhadas.

## Heap

O HEAP está localizado no endereço oposto ao stack e é um pedaço de memória usado para alocação dinâmica. É conhecido como “free store”. Esse pedaço da memória não é gerenciado automaticamente, requerendo que o usuário use explicitamente comandos de alocação e desalocação de memória (como malloc e free).

## BSS

Historicamente chamada de Block Started by Symbol, esta seção contém as variáveis estáticas não-inicializadas. É separada da seção DATA porque as variáveis inicializadas precisam ter seu valor inicial armazenado no arquivo executável, o que não é necessário para as variáveis não-inicializadas. Com essa separação de variáveis, o arquivo executável fica menor.

## Static

A memória estática persiste durante toda a vida do programa. É usada para armazenar variáveis globais ou variáveis criadas com a cláusula static.

---

## Resumo ##

Sobre a organização do programa C na memória. Existem várias seções na memória que são usadas para diferentes fins:

Text: contém o código binário a ser executado pelo processo, gerado durante a compilação e a ligação com as bibliotecas.
Data: contém as variáveis estáticas inicializadas, ou seja, variáveis que estão definidas do início ao fim da execução do processo e cujo valor inicial é declarado no código-fonte do programa.
Stack: é uma estrutura de dados FIFO (first-in-first-out), que é usada para guardar as variáveis usadas dentro de uma função, além do endereço de retorno quando a função acabar.

---

Heap: é um pedaço de memória usado para alocação dinâmica – é conhecido como “free store”. Esse pedaço da memória não é gerenciado automaticamente, requer que o usuário use explicitamente comandos de alocação e desalocação de memória (malloc e free).
BSS: contém as variáveis estáticas não-inicializadas. Esta seção é separada da seção DATA porque as variáveis inicializadas precisam ter seu valor inicial armazenado no arquivo executável, o que não é necessário para as variáveis não-inicializadas.
Static: a memória estática persiste durante toda a vida do programa e é usada para armazenar variáveis globais ou variáveis criadas com a cláusula static.

---

## Perguntas ##

* Quais são as seções principais da memória de um programa C?
* O que é armazenado na seção TEXT?
* O que são variáveis estáticas e onde elas são armazenadas?
* O que é a pilha (stack) e para que ela é usada na execução de um programa C?
* O que é o heap e como ele é gerenciado em um programa C?

---

## Links Adicionais ##

* [Stack e Stack Overflow](https://www.youtube.com/watch?v=jVzSBkbfdiw)
